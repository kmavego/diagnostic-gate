Ниже — **внутренний документ `Canon.md`**, оформленный как **канон проекта Diagnostic Gate**.
Это не презентация и не README, а **внутренний опорный текст**, фиксирующий смысл, границы и принципы. Его задача — не объяснять новичкам, а **не дать проекту деградировать**.

---

# Canon.md

## Diagnostic Gate — внутренний канон проекта

> Этот документ фиксирует **что такое Diagnostic Gate, чем он является и чем не является**, а также какие архитектурные и продуктовые решения считаются каноническими.
> Любые изменения продукта, кода, UX или позиционирования **не должны противоречить этому канону**.

---

## 1. Суть продукта (Core Thesis)

**Diagnostic Gate — это инструмент запрета.**

Он предназначен для того, чтобы:

* **не допускать запуск** образовательных продуктов и программ,
* если они содержат фатальные методологические ошибки,
* выявляемые формализованным каноном и проверяемые машинно.

Diagnostic Gate **не обучает**, **не вдохновляет**, **не генерирует контент**.
Он **разрешает или запрещает** переход проекта в следующее состояние.

Ключевая ценность:

> **Право сказать «нельзя» и заблокировать движение дальше.**

---

## 2. Радикальная проблема рынка

Рынок онлайн-образования **симулирует контроль качества**:

* проверяются формальные признаки (completion rate, тесты по знаниям),
* отсутствует запрет на запуск методологически пустых продуктов,
* ошибки обнаруживаются после выхода в реальный мир (дорого).

Diagnostic Gate решает другую задачу:

* **предотвращение ошибки до запуска**,
* через обязательную валидацию логики, решений и допусков.

---

## 3. Чем Diagnostic Gate НЕ является

Зафиксированные запреты (non-goals):

* ❌ не курс
* ❌ не обучающая платформа
* ❌ не AI-ассистент для генерации курсов
* ❌ не “умный тьютор”
* ❌ не маркетплейс знаний
* ❌ не мотивационный продукт

Любая попытка превратить Diagnostic Gate в “обучение”, “помощь”, “подсказки ради подсказок” — **нарушение канона**.

---

## 4. Архитектурный принцип: State Machine

Проект обучения — это **объект с состоянием**, а не набор файлов или идей.

### Канонические состояния MVP:

* `DRAFT`
* `VALIDATED_PROBLEM`
* `ADMISSION_DEFINED`
* `DECISIONS_DEFINED`
* `ADMISSION_ENFORCED`
* `SCOPE_AND_PATHS_DEFINED`

Переходы между состояниями:

* **возможны только через PASS соответствующего Gate**
* **невозможны вручную**
* **невозможны через UI**

UI — клиент.
Backend — носитель права запрета.

---

## 5. Gate-модель (ядро канона)

Diagnostic Gate состоит из **последовательности Gate**, каждый из которых блокирует отдельный класс фатальных ошибок.

### Gate MVP (01–05)

1. **PROBLEM_VALIDATION_01**
   Запрещает проекты без измеряемой проблемы и цены ошибки.

2. **GOAL_TO_ADMISSION_02**
   Запрещает декларативные цели, не переводимые в правила допуска.

3. **CONTENT_TO_DECISIONS_03**
   Запрещает контент, не связанный с критическими решениями.

4. **ASSESSMENT_TO_ADMISSION_04**
   Запрещает оценивание, не влияющее на допуск.

5. **UNIVERSALITY_FILTER_05**
   Запрещает универсальные курсы “для всех”.

Каждый Gate:

* описан в YAML,
* требует конкретные артефакты,
* содержит логику запретов,
* управляет переходом состояния.

---

## 6. Канон важнее реализации

### Источник истины:

1. **Корпус кейсов (`corpus/*.examples.yaml`)**
2. Канонические Gate-спецификации
3. Только потом — код движка

Код **не определяет поведение**, он лишь исполняет канон.

---

## 7. Движок (Engine)

На текущем этапе реализован:

* **детерминированный MVP-движок**,
* без LLM,
* с жёсткими эвристиками,
* полностью покрытый регрессионными тестами.

Цель движка:

* соответствовать корпусу,
* быть предсказуемым,
* быть тестируемым.

LLM в будущем:

* допустим **только как усилитель**,
* никогда — как финальный судья.

---

## 8. Corpus и тесты (критически важны)

Для каждого Gate существует:

* набор валидных и невалидных примеров,
* ожидаемые `PASS / BLOCK`,
* ожидаемые `error_code`.

Корпус:

* является регрессионным контрактом,
* защищает канон от деградации,
* проверяется автоматически.

Текущий статус:

> **26/26 тестов — PASS**
> Канон и движок синхронизированы.

---

## 9. Продуктовый режим MVP

### Режим работы: полуавтоматический

* решение PASS/BLOCK формализовано и машинное,
* пользователь сам исправляет артефакты,
* человек может подключаться только вне канона (опционально, позже).

### Роль системы:

* не объяснять,
* не уговаривать,
* **блокировать и фиксировать**.

---

## 10. Продуктовая архитектура (MVP)

### SaaS-first

* **Frontend:** Next.js
* **Backend:** FastAPI
* **Engine:** Diagnostic Gate evaluator
* **DB/Auth:** Supabase
* **Хранение:** проекты + submissions (аудит)

Memberlux:

* допустим как слой доступа/платежей,
* **не является ядром продукта**.

---

## 11. Пользовательский цикл (канонический)

1. Пользователь создаёт проект
2. Проходит Gate 01 → 05
3. Получает:

   * либо BLOCK с протоколом,
   * либо PASS и переход состояния
4. В финале — валидированный проект + аудит решений

---

## 12. MVP-границы (жёстко зафиксированы)

В MVP **не допускается**:

* генерация курсов,
* автоматическое “исправление” за пользователя,
* командные роли,
* сложные визуальные редакторы,
* маркетплейс гейтов,
* “умные рекомендации” без запрета.

---

## 13. Критерий успеха продукта

Diagnostic Gate считается успешным, если:

* он **неприятен**, но полезен,
* его боятся обходить,
* ему доверяют право запрета,
* он предотвращает реальные потери времени и денег.

---

## 14. Финальная фиксация

Diagnostic Gate — это:

> **Компилятор для образовательных проектов.**
> Если проект не компилируется — он не имеет права на запуск.

Любое развитие продукта должно:

* усиливать запрет,
* повышать формализуемость,
* увеличивать доверие к канону,
* не размывать границы.

---

**Этот документ — канон.
Нарушение канона = архитектурная ошибка.**

